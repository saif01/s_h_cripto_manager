import{g as E}from"./vform.es-CcOTaIAQ.js";import{m as I}from"./app-_qG5e3qg.js";import{_ as B,B as m,o,k as n,j as d,g as _,y as r,z as k,D as p,M as V,f as u,C as i,A as g,F as D,E as R,N as j,O as Q}from"./_plugin-vue_export-helper-DjLPlrT0.js";const G={mixins:[I],data(){return{currentUrl:"/crypto",paginate_custom:25,sort_field:"total_invested",form:new E({id:"",asset_name:null,asset_id:null,asset_quantity:null,average_asset_price:null,current_price:null}),cryptoOptions:[],selectedCrypto:null,dataLoading:!1,manualPrices:{}}},computed:{portfolioSummary(){if(!this.allData||!this.allData.data)return{totalInvested:0,totalCurrentValue:0,overallPNLUSD:0,overallPNLPercentage:0};const e=this.allData.data.reduce((l,a)=>l+(parseFloat(a.total_invested)||0),0),t=this.allData.data.reduce((l,a)=>{const c=this.effectivePrice(a),b=(parseFloat(a.asset_quantity)||0)*c;return l+b},0),y=t-e,f=e>0?y/e*100:0;return{totalInvested:e,totalCurrentValue:t,overallPNLUSD:y,overallPNLPercentage:f}}},watchers:{},methods:{refreshComponent(){this.getResults(),this.fetchCryptoOptions()},effectivePrice(e){const t=this.manualPrices[e.id],y=t!=null&&t!=="",f=parseFloat(y?t:e.current_price);return isNaN(f)?0:f},clearManualPrice(e){delete this.manualPrices[e.id]},async fetchCryptoOptions(){try{const e=await axios.get("/crypto/options");this.cryptoOptions=e.data.map(t=>({...t,displayText:`${t.name} (${t.symbol})`}))}catch(e){console.error("Error fetching crypto options:",e)}},onCryptoSelect(e){if(e){const t=this.cryptoOptions.find(y=>y.coingecko_id===e);t&&(this.form.asset_name=t.symbol,this.form.asset_id=t.coingecko_id)}else this.form.asset_name=null,this.form.asset_id=null},editDataModel(e,t=null){this.editmode=!0,this.dataModelTitle=t||"Update Data",this.form.fill(e),this.selectedCrypto=e.asset_id,this.dataModalDialog=!0},addDataModel(e=null){this.dataModelTitle=e||"Store Data",this.editmode=!1,this.selectedCrypto=null,this.form.reset(),this.dataModalDialog=!0},calculatePnlPercentage(e){const t=this.effectivePrice(e);if(!t||!e.average_asset_price||!e.total_invested)return"N/A";const y=(parseFloat(e.asset_quantity)||0)*t,f=parseFloat(e.total_invested),a=(y-f)/f*100;return`${a>=0?"+":""}${a.toFixed(2)}%`},calculatePnlUSD(e){const t=this.effectivePrice(e);if(!t||!e.average_asset_price||!e.total_invested)return"N/A";const y=(parseFloat(e.asset_quantity)||0)*t,f=parseFloat(e.total_invested),l=y-f;return`${l>=0?"+":""}$${Math.abs(l).toFixed(2)}`},calculateCurrentValue(e){const t=parseFloat(e.asset_quantity)||0,y=this.effectivePrice(e);return t*y},getPnlClass(e){const t=this.effectivePrice(e);if(!t||!e.total_invested)return"text-grey";const y=(parseFloat(e.asset_quantity)||0)*t,f=parseFloat(e.total_invested),l=y-f;return l>0?"text-success font-weight-bold":l<0?"text-error font-weight-bold":"text-grey"},getOverallPnlClass(){const e=this.portfolioSummary.overallPNLUSD;return e>0?"text-success":e<0?"text-error":"text-grey"},formatPrice(e){if(!e||isNaN(e)||e===0)return"N/A";const y=Math.abs(parseFloat(e))>=.01?2:8;return`$${parseFloat(e).toFixed(y)}`},formatCurrency(e){return!e||isNaN(e)?"0.00":parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")},formatNumber(e){return!e||isNaN(e)?"0.00":parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},created(){this.getResults(),this.fetchCryptoOptions()}},H={class:"d-flex align-center gap-6"},J={class:"d-flex align-center gap-4"},K={class:"text-center"},W={class:"text-h6 font-weight-bold"},X={class:"text-center"},Y={class:"text-h6 font-weight-bold"},Z={class:"text-center"},$={class:"d-flex align-center gap-2"},ee={class:"card-body"},te={key:0},se={class:"table-responsive"},re={style:{width:"15%"}},oe={key:0,class:"ml-1"},le={class:"text-right",style:{width:"8%"}},ne={key:0,class:"ml-1"},ae={class:"text-right",style:{width:"10%"}},ie={key:0,class:"ml-1"},de={class:"text-right",style:{width:"10%"}},ce={key:0,class:"ml-1"},ue={class:"text-right",style:{width:"22%"}},me={key:0,class:"ml-1"},_e={class:"text-right",style:{width:"10%"}},pe={key:0,class:"ml-1"},ye={class:"text-right",style:{width:"5%"}},fe={key:0,class:"ml-1"},ve={class:"text-right",style:{width:"10%"}},he={key:0,class:"ml-1"},ge={key:0,style:{width:"15%"}},ke={key:0,class:"ml-1"},Ce={style:{width:"15%"}},be={class:"d-flex align-center"},Pe=["src","alt"],we={class:"font-weight-medium"},Ve={class:"text-right",style:{width:"12%"}},xe={class:"text-right",style:{width:"20%"}},Ne={class:"d-flex align-center"},Se={class:"text-right",style:{width:"12%"}},qe={class:"text-right",style:{width:"8%"}},ze={class:"text-right",style:{width:"13%"}},Fe={key:0,style:{width:"15%"}},Ue={class:"mt-4"},Me={key:1},Le={key:2},Ae={class:"d-flex align-center"},Oe=["src","alt"],Te=["src","alt"],Ee={key:0},Ie={key:1};function Be(e,t,y,f,l,a){const c=_("v-icon"),x=_("v-chip"),b=_("v-divider"),h=_("v-btn"),N=_("v-card-title"),S=_("v-autocomplete"),C=_("v-col"),P=_("v-text-field"),w=_("v-row"),F=_("v-table"),U=_("v-pagination"),M=_("v-skeleton-loader"),q=_("v-card-text"),z=_("v-card"),L=_("v-list-item"),A=_("v-textarea"),O=_("v-form"),T=_("v-dialog");return o(),m("div",null,[n(z,{class:"crypto-card"},{default:d(()=>[n(N,{class:"d-flex align-center justify-space-between pa-4"},{default:d(()=>[r("div",H,[n(x,{color:"indigo-darken-4",size:"small",class:"text-white px-3"},{default:d(()=>[n(c,{start:"",icon:"mdi-currency-btc",size:"small"}),t[20]||(t[20]=k(" Crypto Portfolio "))]),_:1,__:[20]}),r("div",J,[r("div",K,[t[21]||(t[21]=r("div",{class:"text-caption text-grey-darken-1"},"Invested",-1)),r("div",W,"$"+p(a.formatCurrency(a.portfolioSummary.totalInvested)),1)]),n(b,{vertical:"",class:"mx-2"}),r("div",X,[t[22]||(t[22]=r("div",{class:"text-caption text-grey-darken-1"},"Current",-1)),r("div",Y,"$"+p(a.formatCurrency(a.portfolioSummary.totalCurrentValue)),1)]),n(b,{vertical:"",class:"mx-2"}),r("div",Z,[t[23]||(t[23]=r("div",{class:"text-caption text-grey-darken-1"},"P&L",-1)),r("div",{class:V(["text-h6 font-weight-bold",a.getOverallPnlClass()])}," $"+p(a.formatCurrency(a.portfolioSummary.overallPNLUSD))+" ("+p(a.portfolioSummary.overallPNLPercentage>=0?"+":"")+p(a.portfolioSummary.overallPNLPercentage.toFixed(2))+"%) ",3)])])]),r("div",$,[n(h,{size:"small",color:"primary",variant:"text",onClick:a.refreshComponent,icon:"mdi-refresh",loading:l.dataLoading},null,8,["onClick","loading"]),e.auth&&e.auth.cost_deposit?(o(),u(h,{key:0,size:"small",color:"success",variant:"flat",onClick:t[0]||(t[0]=s=>a.addDataModel("Add Transaction"))},{default:d(()=>[n(c,{start:"",icon:"mdi-plus",size:"small"}),t[24]||(t[24]=k("Add "))]),_:1,__:[24]})):e.auth?i("",!0):(o(),u(h,{key:1,size:"small",color:"success",variant:"flat",href:"/login"},{default:d(()=>[n(c,{start:"",icon:"mdi-login",size:"small"}),t[25]||(t[25]=k("Login "))]),_:1,__:[25]}))])]),_:1}),n(q,null,{default:d(()=>[r("div",ee,[e.allData.data?(o(),m("div",te,[n(w,null,{default:d(()=>[n(C,{cols:"4"},{default:d(()=>[n(S,{"prepend-icon":"mdi-database-eye",modelValue:l.paginate_custom,"onUpdate:modelValue":t[1]||(t[1]=s=>l.paginate_custom=s),label:"Show:",items:e.tblItemNumberShow,title:"Show Per Page",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),n(C,{cols:"8"},{default:d(()=>[n(P,{"prepend-icon":"mdi-clipboard-text-search",label:"Search:",modelValue:e.search_custom,"onUpdate:modelValue":t[2]||(t[2]=s=>e.search_custom=s),placeholder:"Search by any data at the table...",title:"type for search",clearable:"",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),r("div",se,[n(F,{class:"bordered__table",density:"compact",hover:""},{default:d(()=>[r("thead",null,[r("tr",null,[r("th",re,[r("a",{href:"#",onClick:t[3]||(t[3]=g(s=>e.change_sort("asset_name"),["prevent"]))},"Asset"),l.sort_field=="asset_name"?(o(),m("span",oe,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",le,[r("a",{href:"#",onClick:t[4]||(t[4]=g(s=>e.change_sort("pnl_percentage"),["prevent"]))},"P&L (%)"),l.sort_field=="pnl_percentage"?(o(),m("span",ne,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",ae,[r("a",{href:"#",onClick:t[5]||(t[5]=g(s=>e.change_sort("pnl_usd"),["prevent"]))},"P&L (USD)"),l.sort_field=="pnl_usd"?(o(),m("span",ie,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",de,[r("a",{href:"#",onClick:t[6]||(t[6]=g(s=>e.change_sort("average_asset_price"),["prevent"]))},"Average Price"),l.sort_field=="average_asset_price"?(o(),m("span",ce,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",ue,[r("a",{href:"#",onClick:t[7]||(t[7]=g(s=>e.change_sort("current_price"),["prevent"]))},"Current Price"),l.sort_field=="current_price"?(o(),m("span",me,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",_e,[r("a",{href:"#",onClick:t[8]||(t[8]=g(s=>e.change_sort("total_invested"),["prevent"]))},"Total Invested"),l.sort_field=="total_invested"?(o(),m("span",pe,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",ye,[r("a",{href:"#",onClick:t[9]||(t[9]=g(s=>e.change_sort("asset_quantity"),["prevent"]))},"Qty"),l.sort_field=="asset_quantity"?(o(),m("span",fe,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),r("th",ve,[r("a",{href:"#",onClick:t[10]||(t[10]=g(s=>e.change_sort("current_value"),["prevent"]))},"Current Value"),l.sort_field=="current_value"?(o(),m("span",he,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)]),e.auth&&e.auth.cost_deposit?(o(),m("th",ge,[r("a",{href:"#",onClick:t[11]||(t[11]=g(s=>e.change_sort("id"),["prevent"]))},"Action"),l.sort_field=="id"?(o(),m("span",ke,[e.sort_direction=="desc"?(o(),u(c,{key:0,icon:"mdi-sort-ascending"})):i("",!0),e.sort_direction=="asc"?(o(),u(c,{key:1,icon:"mdi-sort-descending"})):i("",!0)])):i("",!0)])):i("",!0)])]),r("tbody",null,[(o(!0),m(D,null,R(e.allData.data,s=>(o(),m("tr",{key:s.id},[r("td",Ce,[r("div",be,[s.coin_image?(o(),m("img",{key:0,src:s.coin_image,alt:s.asset_name,style:{width:"28px",height:"28px","margin-right":"10px","border-radius":"50%"}},null,8,Pe)):(o(),u(c,{key:1,icon:"mdi-currency-btc",size:"28",class:"mr-2"})),r("span",we,p(s.asset_name),1)])]),r("td",{class:V(["text-right",a.getPnlClass(s)]),style:{width:"10%"}},p(a.calculatePnlPercentage(s)),3),r("td",{class:V(["text-right",a.getPnlClass(s)]),style:{width:"12%"}},p(a.calculatePnlUSD(s)),3),r("td",Ve,p(a.formatPrice(s.average_asset_price)),1),r("td",xe,[r("div",Ne,[n(P,{label:a.formatPrice(a.effectivePrice(s)),modelValue:l.manualPrices[s.id],"onUpdate:modelValue":v=>l.manualPrices[s.id]=v,modelModifiers:{number:!0},density:"compact",type:"number",step:"any",variant:"outlined",value:a.effectivePrice(s),placeholder:a.formatPrice(s.current_price),title:"Manual override","hide-details":"",style:{"font-size":"12px"}},null,8,["label","modelValue","onUpdate:modelValue","value","placeholder"]),l.manualPrices[s.id]!==void 0&&l.manualPrices[s.id]!==null&&l.manualPrices[s.id]!==""?(o(),u(h,{key:0,icon:"mdi-close-circle",size:"x-small",variant:"text",class:"ml-1",title:"Clear",onClick:v=>a.clearManualPrice(s)},null,8,["onClick"])):i("",!0)])]),r("td",Se,"$"+p(a.formatCurrency(s.total_invested)),1),r("td",qe,p(a.formatNumber(s.asset_quantity)),1),r("td",ze,"$"+p(a.formatCurrency(a.calculateCurrentValue(s))),1),e.auth&&e.auth.cost_deposit?(o(),m("td",Fe,[s.status==1?(o(),u(h,{key:0,onClick:v=>e.statusChange(s),size:"small",color:"green",variant:"text",icon:"",title:"Active"},{default:d(()=>[n(c,{size:"x-large",icon:"mdi-check-decagram"})]),_:2},1032,["onClick"])):(o(),u(h,{key:1,onClick:v=>e.statusChange(s),size:"small",variant:"text",icon:"",class:"ma-1",title:"Inactive"},{default:d(()=>[n(c,{size:"x-large",icon:"mdi-close-octagon"})]),_:2},1032,["onClick"])),n(h,{class:"ma-1",size:"x-small",color:"warning",onClick:v=>a.editDataModel(s,"Edit Transaction")},{default:d(()=>[n(c,{start:"",icon:"mdi mdi-text-box-edit"}),t[26]||(t[26]=k("Edit "))]),_:2,__:[26]},1032,["onClick"]),n(h,{class:"ma-1",size:"x-small",color:"error",onClick:v=>e.deleteDataTemp(s.id)},{default:d(()=>[n(c,{start:"",icon:"mdi mdi-delete"}),t[27]||(t[27]=k("Del "))]),_:2,__:[27]},1032,["onClick"])])):i("",!0)]))),128))])]),_:1})]),r("div",Ue,[r("span",null,"Total Records: "+p(e.totalValue),1)]),e.v_total>1?(o(),u(U,{key:0,modelValue:e.currentPageNumber,"onUpdate:modelValue":[t[12]||(t[12]=s=>e.currentPageNumber=s),e.getResults],length:e.v_total,"total-visible":7,rounded:"circle",size:"small","active-color":"red",color:"green"},null,8,["modelValue","length","onUpdate:modelValue"])):i("",!0)])):(o(),m("div",Me,[l.dataLoading?(o(),u(M,{key:0,type:"table-tbody"})):i("",!0)])),!e.totalValue&&!l.dataLoading?(o(),m("div",Le,"Data not available")):i("",!0)])]),_:1})]),_:1}),n(T,{modelValue:e.dataModalDialog,"onUpdate:modelValue":t[19]||(t[19]=s=>e.dataModalDialog=s),persistent:"","max-width":"600px"},{default:d(()=>[n(z,null,{default:d(()=>[n(N,{class:"justify-center"},{default:d(()=>[n(w,{align:"center"},{default:d(()=>[n(C,{cols:"10"},{default:d(()=>[k(p(e.dataModelTitle),1)]),_:1}),n(C,{cols:"2"},{default:d(()=>[n(h,{onClick:t[13]||(t[13]=s=>e.dataModalDialog=!1),class:"float-right"},{default:d(()=>t[28]||(t[28]=[k(" Close ")])),_:1,__:[28]})]),_:1})]),_:1})]),_:1}),n(q,null,{default:d(()=>[n(O,{"lazy-validation":""},{default:d(()=>[r("form",{onSubmit:t[18]||(t[18]=g(s=>e.editmode?e.updateData():e.createData(),["prevent"]))},[n(w,null,{default:d(()=>[n(C,{cols:"12"},{default:d(()=>[n(S,{label:"Select Cryptocurrency:",placeholder:"Choose a cryptocurrency",modelValue:l.selectedCrypto,"onUpdate:modelValue":[t[14]||(t[14]=s=>l.selectedCrypto=s),a.onCryptoSelect],items:l.cryptoOptions,"item-title":"displayText","item-value":"coingecko_id","error-messages":l.form.errors.get("asset_name"),rules:[e.v_rules.required],variant:"outlined",class:"required","prepend-inner-icon":"mdi mdi-bitcoin",clearable:""},{selection:d(({item:s})=>[r("div",Ae,[s.raw.image?(o(),m("img",{key:0,src:s.raw.image,alt:s.raw.name,style:{width:"24px",height:"24px","margin-right":"12px","border-radius":"50%"}},null,8,Oe)):(o(),u(c,{key:1,icon:"mdi-currency-btc",size:"24",class:"mr-3"})),r("span",null,[r("strong",null,p(s.raw.name),1),k(" ("+p(s.raw.symbol)+")",1)])])]),item:d(({props:s,item:v})=>[n(L,j(Q(s)),{prepend:d(()=>[v.raw.image?(o(),m("img",{key:0,src:v.raw.image,alt:v.raw.name,style:{width:"32px",height:"32px","border-radius":"50%"}},null,8,Te)):(o(),u(c,{key:1,icon:"mdi-currency-btc",size:"32"}))]),title:d(()=>[r("strong",null,p(v.raw.name),1),k(" ("+p(v.raw.symbol)+") ",1)]),_:2},1040)]),_:1},8,["modelValue","items","error-messages","rules","onUpdate:modelValue"])]),_:1}),n(C,{cols:"12"},{default:d(()=>[n(P,{label:"Asset Quantity:",placeholder:"Enter Asset Quantity",modelValue:l.form.asset_quantity,"onUpdate:modelValue":t[15]||(t[15]=s=>l.form.asset_quantity=s),step:"any","error-messages":l.form.errors.get("asset_quantity"),rules:[e.v_rules.required],required:"",variant:"outlined",class:"required","prepend-inner-icon":"mdi mdi-counter"},null,8,["modelValue","error-messages","rules"])]),_:1}),n(C,{cols:"12"},{default:d(()=>[n(P,{label:"Average Asset Price:",placeholder:"Enter Average Asset Price",modelValue:l.form.average_asset_price,"onUpdate:modelValue":t[16]||(t[16]=s=>l.form.average_asset_price=s),step:"any","error-messages":l.form.errors.get("average_asset_price"),rules:[e.v_rules.required],required:"",variant:"outlined",class:"required","prepend-inner-icon":"mdi mdi-currency-usd"},null,8,["modelValue","error-messages","rules"])]),_:1}),n(C,{cols:"12"},{default:d(()=>[n(A,{type:"text",label:"Details:",placeholder:"Enter Details",modelValue:l.form.details,"onUpdate:modelValue":t[17]||(t[17]=s=>l.form.details=s),counter:"",maxlength:"1000","error-messages":l.form.errors.get("details"),variant:"outlined",rows:"2","prepend-inner-icon":"mdi mdi-text-box-outline"},null,8,["modelValue","error-messages"])]),_:1}),n(h,{block:"",blockdepressed:"",loading:e.dataModalLoading,color:"primary my-3",type:"submit"},{default:d(()=>[e.editmode?(o(),m("span",Ee," Update ")):(o(),m("span",Ie," Create "))]),_:1},8,["loading"])]),_:1})],32)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Qe=B(G,[["render",Be],["__scopeId","data-v-fc13356d"]]);export{Qe as default};
