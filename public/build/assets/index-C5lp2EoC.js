import{g as O}from"./vform.es-CcOTaIAQ.js";import{m as T}from"./app-BqwnbN9s.js";import{_ as E,B as m,o,k as l,j as a,g as f,y as s,f as c,C as d,z as C,D as p,M as N,A as k,F as B,E as D,N as I,O as R}from"./_plugin-vue_export-helper-DjLPlrT0.js";const j={mixins:[T],data(){return{currentUrl:"/crypto",paginate_custom:25,sort_field:"total_invested",form:new O({id:"",asset_name:null,asset_id:null,asset_quantity:null,average_asset_price:null,current_price:null}),cryptoOptions:[],selectedCrypto:null,dataLoading:!1,manualPrices:{}}},computed:{portfolioSummary(){if(!this.allData||!this.allData.data)return{totalInvested:0,totalCurrentValue:0,overallPNLUSD:0,overallPNLPercentage:0};const e=this.allData.data.reduce((n,i)=>n+(parseFloat(i.total_invested)||0),0),t=this.allData.data.reduce((n,i)=>{const g=this.effectivePrice(i),b=(parseFloat(i.asset_quantity)||0)*g;return n+b},0),_=t-e,v=e>0?_/e*100:0;return{totalInvested:e,totalCurrentValue:t,overallPNLUSD:_,overallPNLPercentage:v}}},watchers:{},methods:{refreshComponent(){this.getResults(),this.fetchCryptoOptions()},effectivePrice(e){const t=this.manualPrices[e.id],_=t!=null&&t!=="",v=parseFloat(_?t:e.current_price);return isNaN(v)?0:v},clearManualPrice(e){delete this.manualPrices[e.id]},async fetchCryptoOptions(){try{const e=await axios.get("/crypto/options");this.cryptoOptions=e.data.map(t=>({...t,displayText:`${t.name} (${t.symbol})`}))}catch(e){console.error("Error fetching crypto options:",e)}},onCryptoSelect(e){if(e){const t=this.cryptoOptions.find(_=>_.coingecko_id===e);t&&(this.form.asset_name=t.symbol,this.form.asset_id=t.coingecko_id)}else this.form.asset_name=null,this.form.asset_id=null},editDataModel(e,t=null){this.editmode=!0,this.dataModelTitle=t||"Update Data",this.form.fill(e),this.selectedCrypto=e.asset_id,this.dataModalDialog=!0},addDataModel(e=null){this.dataModelTitle=e||"Store Data",this.editmode=!1,this.selectedCrypto=null,this.form.reset(),this.dataModalDialog=!0},calculatePnlPercentage(e){const t=this.effectivePrice(e);if(!t||!e.average_asset_price||!e.total_invested)return"N/A";const _=(parseFloat(e.asset_quantity)||0)*t,v=parseFloat(e.total_invested),i=(_-v)/v*100;return`${i>=0?"+":""}${i.toFixed(2)}%`},calculatePnlUSD(e){const t=this.effectivePrice(e);if(!t||!e.average_asset_price||!e.total_invested)return"N/A";const _=(parseFloat(e.asset_quantity)||0)*t,v=parseFloat(e.total_invested),n=_-v;return`${n>=0?"+":""}$${Math.abs(n).toFixed(2)}`},calculateCurrentValue(e){const t=parseFloat(e.asset_quantity)||0,_=this.effectivePrice(e);return t*_},getPnlClass(e){const t=this.effectivePrice(e);if(!t||!e.total_invested)return"text-grey";const _=(parseFloat(e.asset_quantity)||0)*t,v=parseFloat(e.total_invested),n=_-v;return n>0?"text-success font-weight-bold":n<0?"text-error font-weight-bold":"text-grey"},getOverallPnlClass(){const e=this.portfolioSummary.overallPNLUSD;return e>0?"text-success":e<0?"text-error":"text-grey"},formatPrice(e){if(!e||isNaN(e)||e===0)return"N/A";const _=Math.abs(parseFloat(e))>=.01?2:8;return`$${parseFloat(e).toFixed(_)}`},formatCurrency(e){return!e||isNaN(e)?"0.00":parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")},formatNumber(e){return!e||isNaN(e)?"0.00":parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},created(){this.getResults(),this.fetchCryptoOptions()}},Q={class:"row align-center"},G={class:"col-6"},H={class:"float-right"},J={class:"card-body"},K={key:0},W={class:"text-h5 font-weight-black text-indigo-darken-4"},X={class:"text-h5 font-weight-black text-indigo-darken-4"},Y={class:"table-responsive"},Z={key:0,class:"ml-1"},$={class:"text-right"},ee={key:0,class:"ml-1"},te={class:"text-right"},re={key:0,class:"ml-1"},se={class:"text-right"},oe={key:0,class:"ml-1"},le={class:"text-right"},ne={key:0,class:"ml-1"},ae={class:"text-right"},ie={key:0,class:"ml-1"},de={class:"text-right"},ce={key:0,class:"ml-1"},ue={class:"text-right"},me={key:0,class:"ml-1"},pe={key:0},_e={key:0,class:"ml-1"},fe={class:"d-flex align-center"},ge=["src","alt"],ve={class:"font-weight-medium"},ye={class:"text-right"},he={class:"text-right"},ke={class:"d-flex align-center justify-end"},Ce={class:"text-primary font-weight-bold",style:{"min-width":"120px"}},be={class:"text-right"},Pe={class:"text-right"},Ve={class:"text-right"},we={key:0},xe={class:"mt-4"},Ne={key:1},Se={key:2},qe={class:"d-flex align-center"},Fe=["src","alt"],Ue=["src","alt"],Me={key:0},Le={key:1};function ze(e,t,_,v,n,i){const g=f("v-btn"),u=f("v-icon"),b=f("v-card-title"),h=f("v-col"),P=f("v-row"),w=f("v-card-text"),x=f("v-card"),S=f("v-autocomplete"),V=f("v-text-field"),q=f("v-table"),F=f("v-pagination"),U=f("v-skeleton-loader"),M=f("v-list-item"),L=f("v-textarea"),z=f("v-form"),A=f("v-dialog");return o(),m("div",null,[l(x,null,{default:a(()=>[l(b,null,{default:a(()=>[s("div",Q,[t[21]||(t[21]=s("div",{class:"col-6"},[s("h3",null,"Crypto Portfolio")],-1)),s("div",G,[s("div",H,[l(g,{size:"x-large",color:"primary",class:"mr-2",onClick:i.refreshComponent,icon:"mdi-refresh",title:"Refresh",loading:n.dataLoading},null,8,["onClick","loading"]),e.auth&&e.auth.cost_deposit?(o(),c(g,{key:0,size:"x-large",color:"success",onClick:t[0]||(t[0]=r=>i.addDataModel("Add Transaction")),icon:"mdi-plus-box",title:"Add"})):e.auth?d("",!0):(o(),c(g,{key:1,size:"large",color:"success",href:"/login",title:"Login"},{default:a(()=>[l(u,{start:"",icon:"mdi mdi-login"}),t[20]||(t[20]=C(" Login"))]),_:1,__:[20]}))])])])]),_:1}),l(w,null,{default:a(()=>[s("div",J,[e.allData.data?(o(),m("div",K,[l(x,{class:"mb-6 bg-indigo-lighten-5 rounded-xl",elevation:"2"},{default:a(()=>[l(w,null,{default:a(()=>[l(P,null,{default:a(()=>[l(h,{cols:"12",md:"4"},{default:a(()=>[t[22]||(t[22]=s("div",{class:"text-caption text-indigo-darken-2"},"Total Invested",-1)),s("div",W," $"+p(i.formatCurrency(i.portfolioSummary.totalInvested)),1)]),_:1,__:[22]}),l(h,{cols:"12",md:"4"},{default:a(()=>[t[23]||(t[23]=s("div",{class:"text-caption text-indigo-darken-2"},"Current Portfolio Value",-1)),s("div",X," $"+p(i.formatCurrency(i.portfolioSummary.totalCurrentValue)),1)]),_:1,__:[23]}),l(h,{cols:"12",md:"4"},{default:a(()=>[t[24]||(t[24]=s("div",{class:"text-caption text-indigo-darken-2"},"Overall Profit/Loss",-1)),s("div",{class:N(["text-h4 font-weight-black",i.getOverallPnlClass()])}," $"+p(i.formatCurrency(i.portfolioSummary.overallPNLUSD))+" ("+p(i.portfolioSummary.overallPNLPercentage>=0?"+":"")+p(i.portfolioSummary.overallPNLPercentage.toFixed(2))+"%) ",3)]),_:1,__:[24]})]),_:1})]),_:1})]),_:1}),l(P,null,{default:a(()=>[l(h,{cols:"4"},{default:a(()=>[l(S,{"prepend-icon":"mdi-database-eye",modelValue:n.paginate_custom,"onUpdate:modelValue":t[1]||(t[1]=r=>n.paginate_custom=r),label:"Show:",items:e.tblItemNumberShow,title:"Show Per Page",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),l(h,{cols:"8"},{default:a(()=>[l(V,{"prepend-icon":"mdi-clipboard-text-search",label:"Search:",modelValue:e.search_custom,"onUpdate:modelValue":t[2]||(t[2]=r=>e.search_custom=r),placeholder:"Search by any data at the table...",title:"type for search",clearable:"",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),s("div",Y,[l(q,{class:"bordered__table",density:"compact",hover:""},{default:a(()=>[s("thead",null,[s("tr",null,[s("th",null,[s("a",{href:"#",onClick:t[3]||(t[3]=k(r=>e.change_sort("asset_name"),["prevent"]))},"Asset"),n.sort_field=="asset_name"?(o(),m("span",Z,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",$,[s("a",{href:"#",onClick:t[4]||(t[4]=k(r=>e.change_sort("pnl_percentage"),["prevent"]))},"P&L (%)"),n.sort_field=="pnl_percentage"?(o(),m("span",ee,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",te,[s("a",{href:"#",onClick:t[5]||(t[5]=k(r=>e.change_sort("pnl_usd"),["prevent"]))},"P&L (USD)"),n.sort_field=="pnl_usd"?(o(),m("span",re,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",se,[s("a",{href:"#",onClick:t[6]||(t[6]=k(r=>e.change_sort("average_asset_price"),["prevent"]))},"Average Price"),n.sort_field=="average_asset_price"?(o(),m("span",oe,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",le,[s("a",{href:"#",onClick:t[7]||(t[7]=k(r=>e.change_sort("current_price"),["prevent"]))},"Current Price"),n.sort_field=="current_price"?(o(),m("span",ne,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",ae,[s("a",{href:"#",onClick:t[8]||(t[8]=k(r=>e.change_sort("total_invested"),["prevent"]))},"Total Invested"),n.sort_field=="total_invested"?(o(),m("span",ie,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",de,[s("a",{href:"#",onClick:t[9]||(t[9]=k(r=>e.change_sort("asset_quantity"),["prevent"]))},"Qty"),n.sort_field=="asset_quantity"?(o(),m("span",ce,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),s("th",ue,[s("a",{href:"#",onClick:t[10]||(t[10]=k(r=>e.change_sort("current_value"),["prevent"]))},"Current Value"),n.sort_field=="current_value"?(o(),m("span",me,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)]),e.auth&&e.auth.cost_deposit?(o(),m("th",pe,[s("a",{href:"#",onClick:t[11]||(t[11]=k(r=>e.change_sort("id"),["prevent"]))},"Action"),n.sort_field=="id"?(o(),m("span",_e,[e.sort_direction=="desc"?(o(),c(u,{key:0,icon:"mdi-sort-ascending"})):d("",!0),e.sort_direction=="asc"?(o(),c(u,{key:1,icon:"mdi-sort-descending"})):d("",!0)])):d("",!0)])):d("",!0)])]),s("tbody",null,[(o(!0),m(B,null,D(e.allData.data,r=>(o(),m("tr",{key:r.id},[s("td",null,[s("div",fe,[r.coin_image?(o(),m("img",{key:0,src:r.coin_image,alt:r.asset_name,style:{width:"28px",height:"28px","margin-right":"10px","border-radius":"50%"}},null,8,ge)):(o(),c(u,{key:1,icon:"mdi-currency-btc",size:"28",class:"mr-2"})),s("span",ve,p(r.asset_name),1)])]),s("td",{class:N(["text-right",i.getPnlClass(r)])},p(i.calculatePnlPercentage(r)),3),s("td",{class:N(["text-right",i.getPnlClass(r)])},p(i.calculatePnlUSD(r)),3),s("td",ye,p(i.formatPrice(r.average_asset_price)),1),s("td",he,[s("div",ke,[l(V,{modelValue:n.manualPrices[r.id],"onUpdate:modelValue":y=>n.manualPrices[r.id]=y,modelModifiers:{number:!0},class:"mr-2",density:"compact",type:"number",step:"any",variant:"underlined",placeholder:i.formatPrice(r.current_price),title:"Enter manual price to override market",style:{"max-width":"140px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),s("div",Ce,p(i.formatPrice(i.effectivePrice(r))),1),n.manualPrices[r.id]!==void 0&&n.manualPrices[r.id]!==null&&n.manualPrices[r.id]!==""?(o(),c(g,{key:0,icon:"mdi-close-circle",size:"x-small",variant:"text",class:"ml-1",title:"Clear manual price",onClick:y=>i.clearManualPrice(r)},null,8,["onClick"])):d("",!0)])]),s("td",be,"$"+p(i.formatCurrency(r.total_invested)),1),s("td",Pe,p(i.formatNumber(r.asset_quantity)),1),s("td",Ve,"$"+p(i.formatCurrency(i.calculateCurrentValue(r))),1),e.auth&&e.auth.cost_deposit?(o(),m("td",we,[r.status==1?(o(),c(g,{key:0,onClick:y=>e.statusChange(r),size:"small",color:"green",variant:"text",icon:"",title:"Active"},{default:a(()=>[l(u,{size:"x-large",icon:"mdi-check-decagram"})]),_:2},1032,["onClick"])):(o(),c(g,{key:1,onClick:y=>e.statusChange(r),size:"small",variant:"text",icon:"",class:"ma-1",title:"Inactive"},{default:a(()=>[l(u,{size:"x-large",icon:"mdi-close-octagon"})]),_:2},1032,["onClick"])),l(g,{class:"ma-1",size:"x-small",color:"warning",onClick:y=>i.editDataModel(r,"Edit Transaction")},{default:a(()=>[l(u,{start:"",icon:"mdi mdi-text-box-edit"}),t[25]||(t[25]=C("Edit "))]),_:2,__:[25]},1032,["onClick"]),l(g,{class:"ma-1",size:"x-small",color:"error",onClick:y=>e.deleteDataTemp(r.id)},{default:a(()=>[l(u,{start:"",icon:"mdi mdi-delete"}),t[26]||(t[26]=C("Del "))]),_:2,__:[26]},1032,["onClick"])])):d("",!0)]))),128))])]),_:1})]),s("div",xe,[s("span",null,"Total Records: "+p(e.totalValue),1)]),e.v_total>1?(o(),c(F,{key:0,modelValue:e.currentPageNumber,"onUpdate:modelValue":[t[12]||(t[12]=r=>e.currentPageNumber=r),e.getResults],length:e.v_total,"total-visible":7,rounded:"circle",size:"small","active-color":"red",color:"green"},null,8,["modelValue","length","onUpdate:modelValue"])):d("",!0)])):(o(),m("div",Ne,[n.dataLoading?(o(),c(U,{key:0,type:"table-tbody"})):d("",!0)])),!e.totalValue&&!n.dataLoading?(o(),m("div",Se,"Data not available")):d("",!0)])]),_:1})]),_:1}),l(A,{modelValue:e.dataModalDialog,"onUpdate:modelValue":t[19]||(t[19]=r=>e.dataModalDialog=r),persistent:"","max-width":"600px"},{default:a(()=>[l(x,null,{default:a(()=>[l(b,{class:"justify-center"},{default:a(()=>[l(P,{align:"center"},{default:a(()=>[l(h,{cols:"10"},{default:a(()=>[C(p(e.dataModelTitle),1)]),_:1}),l(h,{cols:"2"},{default:a(()=>[l(g,{onClick:t[13]||(t[13]=r=>e.dataModalDialog=!1),class:"float-right"},{default:a(()=>t[27]||(t[27]=[C(" Close ")])),_:1,__:[27]})]),_:1})]),_:1})]),_:1}),l(w,null,{default:a(()=>[l(z,{"lazy-validation":""},{default:a(()=>[s("form",{onSubmit:t[18]||(t[18]=k(r=>e.editmode?e.updateData():e.createData(),["prevent"]))},[l(P,null,{default:a(()=>[l(h,{cols:"12"},{default:a(()=>[l(S,{label:"Select Cryptocurrency:",placeholder:"Choose a cryptocurrency",modelValue:n.selectedCrypto,"onUpdate:modelValue":[t[14]||(t[14]=r=>n.selectedCrypto=r),i.onCryptoSelect],items:n.cryptoOptions,"item-title":"displayText","item-value":"coingecko_id","error-messages":n.form.errors.get("asset_name"),rules:[e.v_rules.required],variant:"outlined",class:"required","prepend-inner-icon":"mdi mdi-bitcoin",clearable:""},{selection:a(({item:r})=>[s("div",qe,[r.raw.image?(o(),m("img",{key:0,src:r.raw.image,alt:r.raw.name,style:{width:"24px",height:"24px","margin-right":"12px","border-radius":"50%"}},null,8,Fe)):(o(),c(u,{key:1,icon:"mdi-currency-btc",size:"24",class:"mr-3"})),s("span",null,[s("strong",null,p(r.raw.name),1),C(" ("+p(r.raw.symbol)+")",1)])])]),item:a(({props:r,item:y})=>[l(M,I(R(r)),{prepend:a(()=>[y.raw.image?(o(),m("img",{key:0,src:y.raw.image,alt:y.raw.name,style:{width:"32px",height:"32px","border-radius":"50%"}},null,8,Ue)):(o(),c(u,{key:1,icon:"mdi-currency-btc",size:"32"}))]),title:a(()=>[s("strong",null,p(y.raw.name),1),C(" ("+p(y.raw.symbol)+") ",1)]),_:2},1040)]),_:1},8,["modelValue","items","error-messages","rules","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12"},{default:a(()=>[l(V,{label:"Asset Quantity:",placeholder:"Enter Asset Quantity",modelValue:n.form.asset_quantity,"onUpdate:modelValue":t[15]||(t[15]=r=>n.form.asset_quantity=r),step:"any","error-messages":n.form.errors.get("asset_quantity"),rules:[e.v_rules.required],required:"",variant:"outlined",class:"required","prepend-inner-icon":"mdi mdi-counter"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(h,{cols:"12"},{default:a(()=>[l(V,{label:"Average Asset Price:",placeholder:"Enter Average Asset Price",modelValue:n.form.average_asset_price,"onUpdate:modelValue":t[16]||(t[16]=r=>n.form.average_asset_price=r),step:"any","error-messages":n.form.errors.get("average_asset_price"),rules:[e.v_rules.required],required:"",variant:"outlined",class:"required","prepend-inner-icon":"mdi mdi-currency-usd"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(h,{cols:"12"},{default:a(()=>[l(L,{type:"text",label:"Details:",placeholder:"Enter Details",modelValue:n.form.details,"onUpdate:modelValue":t[17]||(t[17]=r=>n.form.details=r),counter:"",maxlength:"1000","error-messages":n.form.errors.get("details"),variant:"outlined",rows:"2","prepend-inner-icon":"mdi mdi-text-box-outline"},null,8,["modelValue","error-messages"])]),_:1}),l(g,{block:"",blockdepressed:"",loading:e.dataModalLoading,color:"primary my-3",type:"submit"},{default:a(()=>[e.editmode?(o(),m("span",Me," Update ")):(o(),m("span",Le," Create "))]),_:1},8,["loading"])]),_:1})],32)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ee=E(j,[["render",ze]]);export{Ee as default};
